IF
	StateCheck(Myself,STATE_SILENCED)
	HaveSpell(WIZARD_VOCALIZE)  // SPWI219.SPL (Vocalize)
	IsSpellTargetValid(Myself,WIZARD_VOCALIZE,0)  // SPWI219.SPL (Vocalize)
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_VOCALIZE)  // SPWI219.SPL (Vocalize)
		WaitAnimation(Myself,WALK)
		WaitAnimation(Myself,CONJURE)
		WaitAnimation(Myself,CAST)
END

IF
	HitBy([GOODCUTOFF],MAGIC)
	IsSpellTargetValid(LastMarkedObject,WIZARD_DEAFNESS,0)  // SPWI224.SPL (Deafness)
	HaveSpell(WIZARD_DEAFNESS)  // SPWI224.SPL (Deafness)
THEN
	RESPONSE #100
		Spell(LastMarkedObject,WIZARD_DEAFNESS)  // SPWI224.SPL (Deafness)
		Wait(2)
		RunAwayFrom(NearestEnemyOf(Myself),5)
END

IF
	AttackedBy([0.UNDEAD],DEFAULT)
	IsSpellTargetValid(LastMarkedObject,WIZARD_CHILL_TOUCH,0)  // SPWI117.SPL (Chill Touch)
	HaveSpell(WIZARD_CHILL_TOUCH)  // SPWI117.SPL (Chill Touch)
	!HasItem("CTouch",Myself)  // Chill Touch
THEN
	RESPONSE #100
		Spell(Myself,WIZARD_CHILL_TOUCH)  // SPWI117.SPL (Chill Touch)
		Wait(1)
		RunAwayFrom(NearestEnemyOf(Myself),6)
END

IF
	Or(2)
		AttackedBy([0.UNDEAD],DEFAULT)
		See([GOODCUTOFF.UNDEAD],0)
	!StateCheck(LastMarkedObject,STATE_PANIC)
	HasItem("CTouch",Myself)  // Chill Touch
THEN
	RESPONSE #100
		AttackOneRound(LastMarkedObject)
END

IF
	!See([GOODCUTOFF.UNDEAD],0)
	HasItem("CTouch",Myself)  // Chill Touch
THEN
	RESPONSE #100
		DestroyItem("CTouch")  // Chill Touch
END

IF
	HasItem("00potn04",Myself)  // Potion of Healing
	HPPercentLT(Myself,33)
THEN
	RESPONSE #100
		UseItem("00potn04",Myself)  // Potion of Healing
END

IF
	ForceMarkedSpell(MARKED_SPELL)
	SetSpellTarget(Nothing)
	!Global("OBJ_SP_53DROSSC_0","LOCALS",-1)
	SetLastMarkedObject(Myself)
THEN
	RESPONSE #100
		MarkSpellAndObject("2228242622122408",Myself,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_DEATH_ARMOR, WIZARD_FIRESHIELD_BLUE, WIZARD_MIRROR_IMAGE, WIZARD_STONESKIN]
		Continue()
END

IF
	!IsMarkedSpell(MARKED_SPELL)
THEN
	RESPONSE #100
		StartTimer(51,2)
		Spell(SpellTarget,MARKED_SPELL)
		WaitAnimation(Myself,WALK)
		WaitAnimation(Myself,CONJURE)
		WaitAnimation(Myself,CAST)
		ForceMarkedSpell(MARKED_SPELL)
		SetGlobal("OBJ_SP_53DROSSC_0","LOCALS",-1)
END

IF
	ForceMarkedSpell(MARKED_SPELL)
	SetSpellTarget(Nothing)
	!Global("OBJ_SP_53DROSSC_1","LOCALS",-1)
	!TimerActive(51)
	!AttackedBy([ENEMY],DEFAULT)
	SetLastMarkedObject(Myself)
THEN
	RESPONSE #100
		MarkSpellAndObject("222824262212240822142223",Myself,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_DEATH_ARMOR, WIZARD_FIRESHIELD_BLUE, WIZARD_MIRROR_IMAGE, WIZARD_STONESKIN, WIZARD_STRENGTH, WIZARD_CATS_GRACE]
		MarkSpellAndObject("22142223",[ENEMY.0.ELF],SPELLCAST_RANDOM)  // [WIZARD_STRENGTH, WIZARD_CATS_GRACE]
		Continue()
	RESPONSE #100
		MarkSpellAndObject("22142223",[ENEMY.0.ELF],SPELLCAST_RANDOM)  // [WIZARD_STRENGTH, WIZARD_CATS_GRACE]
		MarkSpellAndObject("222824262212240822142223",Myself,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_DEATH_ARMOR, WIZARD_FIRESHIELD_BLUE, WIZARD_MIRROR_IMAGE, WIZARD_STONESKIN, WIZARD_STRENGTH, WIZARD_CATS_GRACE]
		Continue()
END

IF
	!IsMarkedSpell(MARKED_SPELL)
THEN
	RESPONSE #100
		StartTimer(51,2)
		Spell(SpellTarget,MARKED_SPELL)
		WaitAnimation(Myself,WALK)
		WaitAnimation(Myself,CONJURE)
		WaitAnimation(Myself,CAST)
		ForceMarkedSpell(MARKED_SPELL)
		SetGlobal("OBJ_SP_53DROSSC_1","LOCALS",-1)
END

IF
	ForceMarkedSpell(MARKED_SPELL)
	SetSpellTarget(Nothing)
	!Global("OBJ_SP_53DROSSC_2","LOCALS",-1)
	See(NearestEnemyOf(Myself),0)
THEN
	RESPONSE #100
		MarkSpellAndObject("2305",Myself,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM | SPELLCAST_IGNORE_HAS_CHECK)  // [WIZARD_HASTE]
		MarkSpellAndObject("231623182306",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM | SPELLCAST_IGNORE_HAS_CHECK)  // [WIZARD_DIRE_CHARM, WIZARD_ICELANCE, WIZARD_HOLD_PERSON]
		Continue()
	RESPONSE #100
		MarkSpellAndObject("231623182306",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM | SPELLCAST_IGNORE_HAS_CHECK)  // [WIZARD_DIRE_CHARM, WIZARD_ICELANCE, WIZARD_HOLD_PERSON]
		MarkSpellAndObject("2305",Myself,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM | SPELLCAST_IGNORE_HAS_CHECK)  // [WIZARD_HASTE]
		Continue()
END

IF
	!IsMarkedSpell(MARKED_SPELL)
THEN
	RESPONSE #100
		ReallyForceSpell(SpellTarget,MARKED_SPELL)
		ForceMarkedSpell(MARKED_SPELL)
		SetGlobal("OBJ_SP_53DROSSC_2","LOCALS",-1)
		AttackOneRound(LastMarkedObject)
END

IF
	ForceMarkedSpell(MARKED_SPELL)
	SetSpellTarget(Nothing)
	!Global("OBJ_SP_53DROSSC_3","LOCALS",-1)
	See(NearestEnemyOf(Myself),0)
THEN
	RESPONSE #100
		MarkSpellAndObject("2214",Myself,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_STRENGTH]
		MarkSpellAndObject("222622222211",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_RAY_OF_ENFEEBLEMENT, WIZARD_BLINDNESS, WIZARD_MELFS_ACID_ARROW]
		Continue()
	RESPONSE #100
		MarkSpellAndObject("222622222211",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_RAY_OF_ENFEEBLEMENT, WIZARD_BLINDNESS, WIZARD_MELFS_ACID_ARROW]
		MarkSpellAndObject("2214",Myself,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_STRENGTH]
		Continue()
END

IF
	!IsMarkedSpell(MARKED_SPELL)
THEN
	RESPONSE #100
		Spell(SpellTarget,MARKED_SPELL)
		WaitAnimation(Myself,WALK)
		WaitAnimation(Myself,CONJURE)
		WaitAnimation(Myself,CAST)
		ForceMarkedSpell(MARKED_SPELL)
		SetGlobal("OBJ_SP_53DROSSC_3","LOCALS",-1)
		AttackOneRound(LastMarkedObject)
END

IF
	ForceMarkedSpell(MARKED_SPELL)
	SetSpellTarget(Nothing)
	!Global("OBJ_SP_53DROSSC_4","LOCALS",-1)
	See(NearestEnemyOf(Myself),0)
THEN
	RESPONSE #100
		MarkSpellAndObject("21122118",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_MAGIC_MISSILE, WIZARD_CHROMATIC_ORB]
		MarkSpellAndObject("22052104",[PC.0.0.0.0.0.0.0.0.CLASSMASK_GROUP_WARRIORS],SPELLCAST_RANDOM)  // [WIZARD_HORROR, WIZARD_CHARM_PERSON]
		Continue()
	RESPONSE #100
		MarkSpellAndObject("22052104",[PC.0.0.0.0.0.0.0.0.CLASSMASK_GROUP_WARRIORS],SPELLCAST_RANDOM)  // [WIZARD_HORROR, WIZARD_CHARM_PERSON]
		MarkSpellAndObject("21122118",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_MAGIC_MISSILE, WIZARD_CHROMATIC_ORB]
		Continue()
END

IF
	!IsMarkedSpell(MARKED_SPELL)
THEN
	RESPONSE #100
		Spell(SpellTarget,MARKED_SPELL)
		WaitAnimation(Myself,WALK)
		WaitAnimation(Myself,CONJURE)
		WaitAnimation(Myself,CAST)
		ForceMarkedSpell(MARKED_SPELL)
		SetGlobal("OBJ_SP_53DROSSC_4","LOCALS",-1)
		AttackOneRound(LastMarkedObject)
END

IF
	ForceMarkedSpell(MARKED_SPELL)
	SetSpellTarget(Nothing)
	!TimerActive(51)
	See(NearestEnemyOf(Myself),0)
THEN
	RESPONSE #100
		MarkSpellAndObject("21122112210322112226222622222118",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_MAGIC_MISSILE, WIZARD_MAGIC_MISSILE, WIZARD_BURNING_HANDS, WIZARD_MELFS_ACID_ARROW, WIZARD_RAY_OF_ENFEEBLEMENT, WIZARD_RAY_OF_ENFEEBLEMENT, WIZARD_BLINDNESS, WIZARD_CHROMATIC_ORB]
		MarkSpellAndObject("220523122318",FarthestEnemyOf(Myself),SPELLCAST_RANDOM)  // [WIZARD_HORROR, WIZARD_SLOW, WIZARD_ICELANCE]
		MarkSpellAndObject("2308",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_LIGHTNING_BOLT]
		Continue()
	RESPONSE #100
		MarkSpellAndObject("220523122318",FarthestEnemyOf(Myself),SPELLCAST_RANDOM)  // [WIZARD_HORROR, WIZARD_SLOW, WIZARD_ICELANCE]
		MarkSpellAndObject("2308",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_LIGHTNING_BOLT]
		MarkSpellAndObject("21122112210322112226222622222118",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_MAGIC_MISSILE, WIZARD_MAGIC_MISSILE, WIZARD_BURNING_HANDS, WIZARD_MELFS_ACID_ARROW, WIZARD_RAY_OF_ENFEEBLEMENT, WIZARD_RAY_OF_ENFEEBLEMENT, WIZARD_BLINDNESS, WIZARD_CHROMATIC_ORB]
		Continue()
	RESPONSE #100
		MarkSpellAndObject("2308",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_LIGHTNING_BOLT]
		MarkSpellAndObject("21122112210322112226222622222118",LastMarkedObject,SPELLCAST_IGNORE_SEE | SPELLCAST_IGNORE_VALID_SPELL_TARGET | SPELLCAST_RANDOM)  // [WIZARD_MAGIC_MISSILE, WIZARD_MAGIC_MISSILE, WIZARD_BURNING_HANDS, WIZARD_MELFS_ACID_ARROW, WIZARD_RAY_OF_ENFEEBLEMENT, WIZARD_RAY_OF_ENFEEBLEMENT, WIZARD_BLINDNESS, WIZARD_CHROMATIC_ORB]
		MarkSpellAndObject("220523122318",FarthestEnemyOf(Myself),SPELLCAST_RANDOM)  // [WIZARD_HORROR, WIZARD_SLOW, WIZARD_ICELANCE]
		Continue()
END

IF
	!IsMarkedSpell(MARKED_SPELL)
THEN
	RESPONSE #100
		StartTimer(51,1)
		Spell(SpellTarget,MARKED_SPELL)
		WaitAnimation(Myself,WALK)
		WaitAnimation(Myself,CONJURE)
		WaitAnimation(Myself,CAST)
		ForceMarkedSpell(MARKED_SPELL)
END

IF
	See(NearestEnemyOf(Myself),0)
THEN
	RESPONSE #100
		EquipWeapon()
		AttackOneRound(LastMarkedObject)
END

